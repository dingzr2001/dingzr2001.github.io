<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hexo"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hexo"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Hexo"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Hexo"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="John Doe"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Hexo","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"John Doe"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-15T17:50:00.000Z" title="6/15/2024, 1:50:00 PM">2024-06-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.150Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/">C++</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/job/">job</a></span><span class="level-item">8 minutes read (About 1235 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/15/Knapsack%20Problems/">&lt;数据结构/算法&gt; 各种背包问题详解（01背包，完全背包，多重背包）</a></p><div class="content"><h1 id="动态规划-各种背包问题详解"><a href="#动态规划-各种背包问题详解" class="headerlink" title="# 动态规划-各种背包问题详解"></a># 动态规划-各种背包问题详解</h1><p>记得当时学算法的时候可喜欢写背包问题了，因为学会了有种豁然开朗的感觉，仿佛掌握了武功秘籍。这篇文章就来记录一下各种背包问题的场景和解法。</p>
<h3 id="1-01背包问题"><a href="#1-01背包问题" class="headerlink" title="1. 01背包问题"></a>1. 01背包问题</h3><p>01背包问题是这样的：</p>
<blockquote>
<p>假如有一组n个物品，每个物品i都有一个体积v<del>i</del>和一个价值s<del>i</del>，现在有一个容量有限为V的背包，如何在不超过该背包容量的情况下装走总价值最大的物品？</p>
</blockquote>
<p>这个问题的思想是通过从少到多地考虑装入的物品。首先将物品进行编号，然后使用一个二维的dp数组保存子问题的解。$dp[i][j]$表示考虑前i个物品，背包容量为j时所能装入的最大价值，那么问题的所求就是$dp[n][V]$</p>
<p>$dp[i][j]$可能包含第i个物品，也可能不包含。不包含时就是$dp[i-1][j]$，包含时就是$dp[i-1][j-v_i]+s_i$，也就是第i个物品的价值，加上去掉第i个物品占的空间后，装前i-1个物品最大能获得多少价值。因此有状态转移方程：</p>
<p>$dp[i][j]&#x3D;max(dp[i-1][j], dp[i-1][j-v_i]+s_i)$</p>
<p>那么怎样动态地更新这个二维数组呢？答案是都行，即可以每次增加一个容量，也可以每次增加一个物品。这里按照每次增加一个物品来写。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxValue</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; volume, vector&lt;<span class="type">int</span>&gt;&amp; value, <span class="type">int</span> V)</span></span>&#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; dp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; volume.<span class="built_in">size</span>() + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">row</span><span class="params">(V + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            dp.<span class="built_in">push_back</span>(row);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; volume.<span class="built_in">size</span>() + <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; V + <span class="number">1</span>; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i == <span class="number">0</span> || j == <span class="number">0</span>)&#123;</span><br><span class="line">                    dp[i][j] = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;  </span><br><span class="line">                <span class="type">int</span> newMax = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(j &gt;= volume[i<span class="number">-1</span>])&#123;</span><br><span class="line">                    newMax = dp[i - <span class="number">1</span>][j - volume[i<span class="number">-1</span>]] + value[i<span class="number">-1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], newMax);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[volume.<span class="built_in">size</span>()][V];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; volume&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>&#125;;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; value&#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">10</span>&#125;;</span><br><span class="line">    <span class="type">int</span> V = <span class="number">20</span>;</span><br><span class="line">    Solution s;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;max value: &quot;</span> &lt;&lt; s.<span class="built_in">maxValue</span>(volume, value, V);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-完全背包"><a href="#2-完全背包" class="headerlink" title="2. 完全背包"></a>2. 完全背包</h3><p>完全背包就是每个物品有无限个。对于$dp[i][j]$，可以是$dp[i][j-v_i]+s_i$，表示少装一个当前物品的最大价值再加上当前物品的价值；也可以是$dp[i-1][j]$，表示不装当前物品，只装前i-1个物品时的最大价值。也就是</p>
<p>$dp[i][j]&#x3D;max(dp[i][j-v_i]+s_i,dp[i-1][j])$</p>
<p>代码就懒得重新写了，就把上一个的状态转移方程改一下就行。</p>
<h3 id="背包问题优化"><a href="#背包问题优化" class="headerlink" title="背包问题优化"></a>背包问题优化</h3><h4 id="01背包问题优化"><a href="#01背包问题优化" class="headerlink" title="01背包问题优化"></a>01背包问题优化</h4><p>你说这玩意谁研究的呢，太聪明了。</p>
<p>我们看这个一层一层的二维数组，事实上每次只有最下面那行$dp[i-1][1,2,…,V]$才有用，再更新下一行的时候只需要用到之前的最下面那行，因此就可以压缩成一维的，像刷墙一样一遍一遍地覆盖。此时我们只需要一个数组$dp[V]$，在第i次循环中，$dp[j]$就表示考虑前i个物品时，容量为j的背包最大价值。那么状态转移方程就是：</p>
<p>$dp[j]&#x3D;max(dp[j],dp[j-v_i]+s_i)$</p>
<p>这里max里面的$dp[j]$就是上一轮（i-1轮）的，表示考虑前i-1个物品时容量为j的最大价值。那么这里就有一个问题。按照原来的顺序更新，应该从$dp[1]$更新到$dp[V]$，但是更新到后面，$dp[j-v_i]+s_i$又需要用前面的值，但是前面的值又已经被覆盖了，可能就已经包含了第i个物品，这里如果再拿一个，不符合01背包的定义了。因此这里我们需要<strong>倒序</strong>更新，这样保证前面的值还是上一轮的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">knapsack01Optimized</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; volume, vector&lt;<span class="type">int</span>&gt;&amp; value, <span class="type">int</span> V)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(V + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; volume.<span class="built_in">size</span>() + <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = V; j &gt;= <span class="number">0</span>; j--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(j &gt;= volume[i - <span class="number">1</span>])&#123;</span><br><span class="line">                dp[j] = <span class="built_in">max</span>(dp[j], dp[j - volume[i - <span class="number">1</span>]] + value[i - <span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                dp[j] = dp[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[V];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样的时间复杂度其实没变，空间复杂度从$O(NV)$降低为$O(V)$</p>
<h4 id="完全背包问题优化"><a href="#完全背包问题优化" class="headerlink" title="完全背包问题优化"></a>完全背包问题优化</h4><p>01背包问题要从后往前更新，而多重背包问题恰好相反，因为人家就是要考虑算了多个当前物品的情况。区别在哪呢，我们观察完全背包问题的状态转移方程</p>
<p>$dp[i][j]&#x3D;max(dp[i][j-v_i]+s_i,dp[i-1][j])$</p>
<p>可以发现这里出现是$dp[i][j-v_i]$，也就是当前这一层的前面的值，这也就说明我们需要先更新前面再更新后面。</p>
<h3 id="多重背包"><a href="#多重背包" class="headerlink" title="多重背包"></a>多重背包</h3></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-15T17:50:00.000Z" title="6/15/2024, 1:50:00 PM">2024-06-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.152Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/">C++</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/job/">job</a></span><span class="level-item">2 minutes read (About 302 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/15/lc_22_generate_parenthesis/">&lt;数据结构/算法&gt; leetcode hot100系列. 22.括号生成Generate Parenthesis</a></p><div class="content"><h1 id="LeetCode-hot-100-22-括号生成Generate-Parenthesis"><a href="#LeetCode-hot-100-22-括号生成Generate-Parenthesis" class="headerlink" title="[LeetCode hot 100] 22. 括号生成Generate Parenthesis"></a>[LeetCode hot 100] 22. 括号生成Generate Parenthesis</h1><p>这个也是一道回溯题，核心是要意识到一个现有的序列中左括号数量一定不能比右括号少，否则就会出现有右括号没有左括号对应的情况。什么都没有的情况下，第一个只能来左括号，当有一个”(“，第二个就可以是”(“或”)”。如果第二个是”(“，第三个是啥都行，但是如果第二个是”)”，前面的左括号和右括号就全部配对了，第三个就只能是左括号。有了这个思路，每次向下搜索时：</p>
<ul>
<li>如果之前序列左括号总数大于右括号总数，下一个就可以是左括号也可以是右括号。</li>
<li>如果左括号总数等于右括号总数，下一个就只能是左括号。</li>
</ul>
<p>那么就可以写代码了：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">generateParenthesis</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; ans;</span><br><span class="line">        string cur;</span><br><span class="line">        <span class="built_in">backtrack</span>(ans, cur, n, n);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">backtrack</span><span class="params">(vector&lt;string&gt;&amp; ans, string cur, <span class="type">int</span> left, <span class="type">int</span> right)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(left == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(right &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                cur += <span class="string">&quot;)&quot;</span>;</span><br><span class="line">                right--;</span><br><span class="line">            &#125;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(cur);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(left &lt; right)&#123;</span><br><span class="line">            <span class="built_in">backtrack</span>(ans, cur+<span class="string">&quot;(&quot;</span>, left<span class="number">-1</span>, right);</span><br><span class="line">            <span class="built_in">backtrack</span>(ans, cur+<span class="string">&quot;)&quot;</span>, left, right<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">backtrack</span>(ans, cur+<span class="string">&quot;(&quot;</span>, left<span class="number">-1</span>, right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-15T17:50:00.000Z" title="6/15/2024, 1:50:00 PM">2024-06-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.153Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/">C++</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/job/">job</a></span><span class="level-item">4 minutes read (About 578 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/15/lc_46_%E5%85%A8%E6%8E%92%E5%88%97/">&lt;数据结构/算法&gt; leetcode hot100系列. 46.全排列Permutation</a></p><div class="content"><h1 id="LeetCode-hot-100-46-全排列Permutation"><a href="#LeetCode-hot-100-46-全排列Permutation" class="headerlink" title="[LeetCode hot 100] 46. 全排列Permutation"></a>[LeetCode hot 100] 46. 全排列Permutation</h1><p>拿到这道题的时候总感觉答案就在嘴边，但是写了写就感觉怎么都不对劲，原因是没有意识到这是一个回溯题。所谓回溯算法，百度百科给出的定义是：</p>
<blockquote>
<p>回溯法也称试探法，它的基本思想是：从问题的某一种状态（初始状态）出发，搜索从这种状态出发所能达到的所有“状态”，当一条路走到“尽头”的时候（不能再前进），再后退一步或若干步，从另一种可能“状态”出发，继续搜索，直到所有的“路径”（状态）都试探过。这种不断“前进”、不断“回溯”寻找解的方法，就称作“回溯法”。</p>
</blockquote>
<p>回溯算法最大的特征就是它是自顶向下的，也就是从顶部的什么都没有，慢慢往深处探索，在最底端得到答案。</p>
<p>对于这道题而言，一开始是什么都不知道的，假如说有个序列[1, 2, 3]，首先确定出第一个数，可以是[1]，可以是[2]，可以是[3]。当第一个数为1时，再确定第二个数，可以是[1, 2]或[1, 3]，然后确定第三个数。当我们确定第三个数之后的时候，实际上是已经得到了两个答案，就应该把这两个答案立即加到答案集合中。也就是说，我们写出来虽然也是递归的形势，但是只是用递归实现了类似栈的回退作用，答案并不是在最顶层得到，而是在最底层得到。</p>
<p>具体如何操作请见代码。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">permute</span>(vector&lt;<span class="type">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; ans;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; cur;</span><br><span class="line">        <span class="type">int</span>* visited = <span class="keyword">new</span> <span class="type">int</span>[nums.<span class="built_in">size</span>()]&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="built_in">backtrack</span>(nums, cur, visited, ans);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">backtrack</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, vector&lt;<span class="type">int</span>&gt; cur, <span class="type">int</span>* visited, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; ans)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cur.<span class="built_in">size</span>() == nums.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="comment">//探到最底层，得到一个答案，放到结果中</span></span><br><span class="line">            ans.<span class="built_in">push_back</span>(cur);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(visited[i] == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//往下探索一层</span></span><br><span class="line">                cur.<span class="built_in">push_back</span>(nums[i]);</span><br><span class="line">                visited[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">backtrack</span>(nums, cur, visited, ans);</span><br><span class="line">                <span class="comment">//回到当前这一层</span></span><br><span class="line">                visited[i] = <span class="number">0</span>;</span><br><span class="line">                cur.<span class="built_in">pop_back</span>();</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-15T17:50:00.000Z" title="6/15/2024, 1:50:00 PM">2024-06-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.153Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/">C++</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/job/">job</a></span><span class="level-item">2 minutes read (About 270 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/15/lc_695_%E6%9C%80%E5%A4%A7%E5%B2%9B%E5%B1%BF%E9%9D%A2%E7%A7%AF/">&lt;数据结构/算法&gt; leetcode hot100系列. 695.最大岛屿面积</a></p><div class="content"><h1 id="LeetCode-hot-100-695-岛屿的最大面积"><a href="#LeetCode-hot-100-695-岛屿的最大面积" class="headerlink" title="[LeetCode hot 100] 695. 岛屿的最大面积"></a>[LeetCode hot 100] 695. 岛屿的最大面积</h1><p><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/max-area-of-island/description/">题目链接</a></p>
<p>我看这还是一个常考的题目。这种题适合用dfs，从每一个点向四周深度优先搜索，用一个visited数组保存每个点是否被访问过，如果访问过就不要重复计算了。如果访问到0，或者到界外了，就返回0，否则就是上下左右的面积之和再+1（自己本身还占一格）。遇到访问过的也是直接返回0，表示要么在这一次计算中重复访问了，要么就是之前在从别的点开始计算时已经计算过了。</p>
<p>完整代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; grid, <span class="type">int</span> idx1, <span class="type">int</span> idx2, vector&lt;vector&lt;<span class="type">bool</span>&gt;&gt;&amp; visited)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(idx1 &lt; <span class="number">0</span> || idx1 &gt;= grid.<span class="built_in">size</span>() || idx2 &lt; <span class="number">0</span> || idx2 &gt;= grid[<span class="number">0</span>].<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(visited[idx1][idx2] || grid[idx1][idx2] == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// cout&lt;&lt;idx1&lt;&lt;&quot;,&quot;&lt;&lt;idx2&lt;&lt;endl;</span></span><br><span class="line">        visited[idx1][idx2] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(grid, idx1 - <span class="number">1</span>, idx2, visited) +</span><br><span class="line">            <span class="built_in">dfs</span>(grid, idx1 + <span class="number">1</span>, idx2, visited) +</span><br><span class="line">            <span class="built_in">dfs</span>(grid, idx1, idx2 - <span class="number">1</span>, visited) + </span><br><span class="line">            <span class="built_in">dfs</span>(grid, idx1, idx2 + <span class="number">1</span>, visited) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxAreaOfIsland</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">bool</span>&gt;&gt; visited;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; grid.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">tmp</span><span class="params">(grid[<span class="number">0</span>].size(), <span class="literal">false</span>)</span></span>;</span><br><span class="line">            visited.<span class="built_in">push_back</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> maxArea = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; grid.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; grid[<span class="number">0</span>].<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">                maxArea = <span class="built_in">max</span>(maxArea, <span class="built_in">dfs</span>(grid, i, j, visited));</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxArea;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-12T17:50:00.000Z" title="6/12/2024, 1:50:00 PM">2024-06-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.153Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/">C++</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/job/">job</a></span><span class="level-item">a minute read (About 188 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/12/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8FMergeSort/">&lt;数据结构/算法&gt; 2.归并排序Merge Sort</a></p><div class="content"><h1 id="归并排序Merge-Sort"><a href="#归并排序Merge-Sort" class="headerlink" title="归并排序Merge Sort"></a>归并排序Merge Sort</h1><p>归并排序个人感觉理解起来没什么难度，主要就是一个递归地合并子序列的过程，直接写代码，在代码特殊的地方说明一下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;arr, <span class="type">int</span> left, <span class="type">int</span> mid, <span class="type">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tmp</span><span class="params">(right - left + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> pl = left, pr = mid;</span><br><span class="line">    <span class="keyword">while</span>(pl &lt;= mid - <span class="number">1</span> &amp;&amp; pr &lt;= right)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[pl] &lt; arr[pr])&#123;</span><br><span class="line">            tmp.<span class="built_in">push_back</span>(arr[pl++]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            tmp.<span class="built_in">push_back</span>(arr[pr++]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//下面这两个循环只会执行一个，因为不可能左右子列都有元素剩余</span></span><br><span class="line">    <span class="keyword">while</span>(pl &lt;= mid - <span class="number">1</span>)&#123;</span><br><span class="line">        tmp.<span class="built_in">push_back</span>(arr[pl++]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(pr &lt;= right)&#123;</span><br><span class="line">        tmp.<span class="built_in">push_back</span>(arr[pr++]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = left; i &lt;= right; i++)&#123;</span><br><span class="line">        arr[i] = tmp[j++];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;arr, <span class="type">int</span> left, <span class="type">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left &gt;= right) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">mergeSort</span>(arr, left, mid - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">mergeSort</span>(arr, mid, right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-11T23:46:00.000Z" title="6/11/2024, 7:46:00 PM">2024-06-11</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.154Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/">C++</a><span> / </span><a class="link-muted" href="/categories/Algorithm/C/job/">job</a></span><span class="level-item">6 minutes read (About 923 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/11/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8FQuick%20Sort/">&lt;数据结构/算法&gt; 1.快速排序Quick Sort</a></p><div class="content"><h1 id="快速排序Quick-Sort"><a href="#快速排序Quick-Sort" class="headerlink" title="快速排序Quick Sort"></a>快速排序Quick Sort</h1><p>事实上对于快速排序一直以来都是懵懵的，苦想后终于茅塞顿开。</p>
<p>首先，快速排序是一个递归的算法，核心思想是在一个序列中选择一个分界值（Pivot），将该序列中的元素划分为左右两部分，左边的元素均小于分界值，右边的元素大于分界值。然后对左右两边分别递归地执行此操作。</p>
<p>那么怎样执行这个“分成左右两边”的操作呢？目前最简洁的方法是这样的。</p>
<ul>
<li>设立一个快指针fast，一个慢指针slow。快指针用于循环，慢指针用于指向一个位置。</li>
<li>指向的位置是什么呢？就是下一次遇到比pivot值小的元素时，应该把它填在哪里。</li>
<li>那么这个位置怎么确定呢，很简单，从序列最左边开始，每找到一个比pivot值小的元素就放到左边，然后往右挪一下就行了。对应到slow指针也就是每次往slow指针位置放，然后slow++。</li>
<li>那么原来位置上的元素怎么办呢？直接和当前这个快指针指向的元素，也就是那个比pivot值小的元素，互换位置就好了。</li>
<li>这样做，遍历一遍后，比pivot小的值都往左边不断地堆放，最后全在左边了。剩下的比pivot大的值自然就跑到右边去了。</li>
<li>但是还有一个pivot值没有处理，这个值往往是选择序列最左边或者最右边的元素，我们在刚刚的遍历中直接略过。也就是如果选了最左边的元素，一开始遍历就直接从第二个元素开始了。如果是最右边的元素，遍历的时候就到倒数第二个元素停止。</li>
<li>最后剩下的slow元素，很明显是要放到中间的。注意到这个时候slow指针正好就在中间，交换位置即可。这里有两种情况：<ul>
<li>一种是每次交换后slow再++，也就是下一次放就是直接放到slow的位置。这种情况下遍历结束后的slow应该是指向第一个比pivot大的元素，也就是右边序列的最左端。如果pivot是左端点则需要和slow-1位置互换，这样把slow-1也就是最后一个比pivot小的值换到最前面，如果pivot是右端点则直接和slow互换，这样把第一个比pivot大的值换到最后面。</li>
<li>第二种是先slow++再交换，这样每一次交换前需要先把slow++挪到下一个位置。这种情况下遍历结束后的slow就是最后一个比pivot小的元素。对于两种pivot位置和第一种情况同理。</li>
</ul>
</li>
</ul>
<p>以下是C++代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">partition</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;arr, <span class="type">int</span> left, <span class="type">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> pivot = arr[right];</span><br><span class="line">    <span class="type">int</span> slow = left;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> fast = left; fast &lt; right; fast++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[fast] &lt; pivot)&#123;</span><br><span class="line">            <span class="type">int</span> tmp = arr[slow];</span><br><span class="line">            arr[slow] = arr[fast];</span><br><span class="line">            arr[fast] = tmp;</span><br><span class="line">            slow++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    arr[right] = arr[slow];</span><br><span class="line">    arr[slow] = pivot;</span><br><span class="line">    <span class="keyword">return</span> slow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;arr, <span class="type">int</span> left, <span class="type">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p = <span class="built_in">partition</span>(arr, left, right);</span><br><span class="line">    <span class="built_in">quickSort</span>(arr, left, p<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">quickSort</span>(arr, p<span class="number">+1</span>, right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; arr = &#123;<span class="number">7</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>&#125;;</span><br><span class="line">  <span class="built_in">quickSort</span>(arr, <span class="number">0</span>, arr.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arr.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">    cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot;,&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实就是这么简单的道理，不知道自己以前为什么那么久没搞明白，还是太菜了。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-03-23T23:46:00.000Z" title="3/23/2024, 7:46:00 PM">2024-03-23</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.150Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Programming-Language/">Programming Language</a><span> / </span><a class="link-muted" href="/categories/Programming-Language/C/">C++</a></span><span class="level-item">4 minutes read (About 604 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/03/23/CppSTL/">C++ STL常用容器及使用方法</a></p><div class="content"><h1 id="C-的STL库常用数据结构及方法"><a href="#C-的STL库常用数据结构及方法" class="headerlink" title="C++的STL库常用数据结构及方法"></a>C++的STL库常用数据结构及方法</h1><h2 id="1-vector可变数组"><a href="#1-vector可变数组" class="headerlink" title="1. vector可变数组"></a>1. vector可变数组</h2><h3 id="1-1-引入"><a href="#1-1-引入" class="headerlink" title="1.1 引入"></a>1.1 引入</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="1-2-创建"><a href="#1-2-创建" class="headerlink" title="1.2 创建"></a>1.2 创建</h3><ul>
<li>创建空vector</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; vct;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建一定长度的vector</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vct</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建一定长度的vector，并且给所有元素赋初始值</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vct</span><span class="params">(<span class="number">10</span>, <span class="number">1</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建一个指定元素值的vector</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; vct&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用迭代器创建vector</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; tmp&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vct</span><span class="params">(tmp.begin(), tmp.end())</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-方法"><a href="#1-3-方法" class="headerlink" title="1.3 方法"></a>1.3 方法</h3><ul>
<li><p>向尾部添加元素push_back, emplace_back</p>
<p>push_back()会先创建一个临时对象，然后复制或移动到容器尾部。emplace_back是C++ 11新引入的方法，直接在容器尾部创建这个对象。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vct.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">vct.<span class="built_in">emplace_back</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>向某一位置插入元素insert，emplace</p>
<p>同理，emplace是C++ 11新特性</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vct.<span class="built_in">insert</span>(pos, val);<span class="comment">//在pos位置插入元素val</span></span><br><span class="line">vct.<span class="built_in">insert</span>(vct.<span class="built_in">begin</span>()<span class="number">+2</span>, <span class="number">1</span>);<span class="comment">//在下标为2处插入1</span></span><br><span class="line">vct.<span class="built_in">insert</span>(vct.<span class="built_in">begin</span>()<span class="number">+2</span>, <span class="number">3</span>, <span class="number">1</span>);<span class="comment">//在下标为2处插入3个1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>删除尾部元素pop_back</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vct.<span class="built_in">pop_back</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除指定位置的元素erase</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vct.<span class="built_in">erase</span>(vct.<span class="built_in">begin</span>()<span class="number">+2</span>);<span class="comment">//删除下标为2的元素</span></span><br><span class="line">vct.<span class="built_in">erase</span>(vct.<span class="built_in">begin</span>()<span class="number">+2</span>, vct.<span class="built_in">begin</span>()<span class="number">+5</span>);<span class="comment">//删除下标为2到4的元素</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>清空vector</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vct.clear();</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2-stack栈"><a href="#2-stack栈" class="headerlink" title="2. stack栈"></a>2. stack栈</h2><h3 id="2-1-引入"><a href="#2-1-引入" class="headerlink" title="2.1 引入"></a>2.1 引入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stack&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-构造stack对象"><a href="#2-2-构造stack对象" class="headerlink" title="2.2 构造stack对象"></a>2.2 构造stack对象</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stack&lt;<span class="type">int</span>&gt; st;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-方法"><a href="#2-3-方法" class="headerlink" title="2.3 方法"></a>2.3 方法</h3><ul>
<li><p>入栈push</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">st.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">st.<span class="built_in">emplace</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>出栈pop</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">st.<span class="built_in">pop</span>();<span class="comment">//void函数，仅出栈操作</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取栈顶top</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = st.<span class="built_in">top</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>判空empty</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-队列queue"><a href="#3-队列queue" class="headerlink" title="3. 队列queue"></a>3. 队列queue</h2><h3 id="3-1-引入"><a href="#3-1-引入" class="headerlink" title="3.1 引入"></a>3.1 引入</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-构造queue对象"><a href="#3-2-构造queue对象" class="headerlink" title="3.2 构造queue对象"></a>3.2 构造queue对象</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">queue&lt;<span class="type">int</span>&gt; q;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-方法"><a href="#3-3-方法" class="headerlink" title="3.3 方法"></a>3.3 方法</h3><ul>
<li><p>入队push，emplace</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">q.push(1);</span><br><span class="line">q.emplace(1);</span><br></pre></td></tr></table></figure>
</li>
<li><p>出队pop</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q.<span class="built_in">pop</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取队头、队尾元素front，back</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = q.<span class="built_in">front</span>();</span><br><span class="line">a = q.<span class="built_in">back</span>();</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="4-双向队列deque"><a href="#4-双向队列deque" class="headerlink" title="4. 双向队列deque"></a>4. 双向队列deque</h2><h3 id="4-1-引入"><a href="#4-1-引入" class="headerlink" title="4.1 引入"></a>4.1 引入</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;deque&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-构造deque对象"><a href="#4-2-构造deque对象" class="headerlink" title="4.2 构造deque对象"></a>4.2 构造deque对象</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deque&lt;<span class="type">int</span>&gt; dq;</span><br><span class="line"><span class="function">deque&lt;<span class="type">int</span>&gt; <span class="title">dq</span><span class="params">(len, val)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-方法"><a href="#4-3-方法" class="headerlink" title="4.3 方法"></a>4.3 方法</h3><ul>
<li><p>前端插入元素push_front，emplace_front</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dq.<span class="built_in">push_front</span>(<span class="number">1</span>);</span><br><span class="line">dq.<span class="built_in">emplace_front</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>后端插入元素push_back，emplace_back</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dq.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">dq.<span class="built_in">emplace_back</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>前后端出队pop_front，pop_back</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dq.<span class="built_in">pop_front</span>();</span><br><span class="line">dq.<span class="built_in">pop_back</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问元素front，back</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = dq.<span class="built_in">front</span>();</span><br><span class="line"><span class="type">int</span> b = dq.<span class="built_in">back</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>清空clear</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dq.<span class="built_in">clear</span>();</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="5-集合set"><a href="#5-集合set" class="headerlink" title="5. 集合set"></a>5. 集合set</h2><h3 id="5-1-引入"><a href="#5-1-引入" class="headerlink" title="5.1 引入"></a>5.1 引入</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-构造set"><a href="#5-2-构造set" class="headerlink" title="5.2 构造set"></a>5.2 构造set</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set&lt;<span class="type">int</span>&gt; s;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-方法"><a href="#5-3-方法" class="headerlink" title="5.3 方法"></a>5.3 方法</h3><ul>
<li><p>插入元素insert，emplace</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">s.<span class="built_in">emplace</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除元素erase</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.<span class="built_in">erase</span>(<span class="number">1</span>);<span class="comment">//删除值为1的元素</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查找元素count，find</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(s.<span class="built_in">count</span>(<span class="number">1</span>))&#123;<span class="comment">//若存在则返回1，否则返回0</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(s.<span class="built_in">find</span>(<span class="number">1</span>) != s.<span class="built_in">end</span>())&#123;<span class="comment">//若存在则返回迭代器，否则返回end()</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>清空clear</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.<span class="built_in">clear</span>();</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="6-键值映射map"><a href="#6-键值映射map" class="headerlink" title="6. 键值映射map"></a>6. 键值映射map</h2><h3 id="6-1-引入"><a href="#6-1-引入" class="headerlink" title="6.1 引入"></a>6.1 引入</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="6-2-构造"><a href="#6-2-构造" class="headerlink" title="6.2 构造"></a>6.2 构造</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; mp;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-方法"><a href="#6-3-方法" class="headerlink" title="6.3 方法"></a>6.3 方法</h3><ul>
<li><p>插入元素insert, emplace</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mp.<span class="built_in">insert</span>(<span class="built_in">pair</span>&lt;<span class="type">char</span>, <span class="type">int</span>&gt;(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>));</span><br><span class="line">mp.<span class="built_in">emplace</span>(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-02-02T18:15:00.000Z" title="2/2/2024, 1:15:00 PM">2024-02-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.150Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/mlsys/">mlsys</a></span><span class="level-item">6 minutes read (About 869 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/02/SpotServe/">SpotServe, Serving Generative Large Language Models on Preemptible Instances</a></p><div class="content"><h1 id="SpotServe-Serving-Generative-Large-Language-Models-on-Preemptible-Instances"><a href="#SpotServe-Serving-Generative-Large-Language-Models-on-Preemptible-Instances" class="headerlink" title="SpotServe: Serving Generative Large Language Models on Preemptible Instances"></a><strong>SpotServe: Serving Generative Large Language Models on Preemptible Instances</strong></h1><p>Author: Xupeng Miao, et al.</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="Generative-LLM"><a href="#Generative-LLM" class="headerlink" title="Generative LLM"></a>Generative LLM</h3><p><img src="https://lh7-us.googleusercontent.com/__jCtoUnwYaYZ8vWKlfn_-PsE6uQZ41sjjkrQ0it5gVYu5o9_R3DIciYp3GgOunsNsa0Pz5mRqJvuHHwhRx1t64AdmjazFVge6AqVtAC8WouPtAj0S71vs6tbg5f4DaEFC0ndDRucqVq4Ngwt98sAwF3DQ=s2048" alt="img"></p>
<ul>
<li><p>Input: tokens; </p>
</li>
<li><p>Output: token sequence</p>
</li>
<li><p>Stops when: output reaches maximum length&#x2F;ending token <EOT></p>
</li>
</ul>
<h3 id="Two-types-of-GPU-Instances"><a href="#Two-types-of-GPU-Instances" class="headerlink" title="Two types of GPU Instances"></a>Two types of GPU Instances</h3><ul>
<li><p>On-demand GPUs:</p>
<ul>
<li><strong>Expensive</strong></li>
<li>Use anytime you need</li>
</ul>
</li>
<li><p>Preemptible GPU Instances (e.g. Spot Instances):</p>
<ul>
<li><strong>Cheap (run on spare capacity)</strong></li>
<li>Might be Preempted anytime</li>
<li>Offers a grace period after preemption to complete currently running tasks</li>
</ul>
<p><img src="https://lh7-us.googleusercontent.com/DkwxhSsXc0N0WC81IuCqRq9LXtl9aXjPPiM8yei1CeiuHp_jHZOZWvidvJrN-hygJVM_vc9wGKiqVlTVJiv5vhHzOCEXUKpK20txDLNUNcxoz3nKE0O7KDXFiAfXOU85Qax8Nsg1q_sOIDuHFZ148YG1IQ=s2048" alt="img"></p>
</li>
</ul>
<h2 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h2><ul>
<li><p>The number of available preemptible instances changes frequently <strong>&#x3D;&gt;</strong> <strong>Dynamic reparallelization</strong> for optimized serving performance</p>
</li>
<li><p>Restarting LLM results in great overhead of reloading parameters <strong>&#x3D;&gt;</strong> Find the <strong>optimal migration strategy</strong> that minimize the cost</p>
</li>
<li><p>Grace periods may not be long enough for finishing current request</p>
</li>
<li><p>The reduction of throughput during this process might lead to accumulation of subsequent requests</p>
</li>
</ul>
<h2 id="SpotServe"><a href="#SpotServe" class="headerlink" title="SpotServe"></a>SpotServe</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p><img src="https://lh7-us.googleusercontent.com/XZZe4AHfMJmr_CeXTrBMCnfXwgQzDLcx_JWctJd7FrUSSlvNvBLlWeiNsg_rdVoFw-qOODUKmDPkdLP5tIQ-aTJgIwW095JejoCQ2C422osBni5AsSlbR1bBp0M0x0ZSIjhAlCKAZYzGHrAUS4few2Fzpw=s2048" alt="img"></p>
<ul>
<li>Request Manager: handle requests, partition into batches, assign them to instances, send output to users</li>
<li>Instance server: monitor the preemption and acquisition of instances</li>
<li>Meta-context manager: schedule the context migration between GPU instances (parameters, outputs, etc.)</li>
</ul>
<h3 id="Meta-context-Manager"><a href="#Meta-context-Manager" class="headerlink" title="Meta-context Manager"></a>Meta-context Manager</h3><h4 id="Parallelization-Controller"><a href="#Parallelization-Controller" class="headerlink" title="Parallelization Controller"></a>Parallelization Controller</h4><h5 id="Parallelization-Configurations"><a href="#Parallelization-Configurations" class="headerlink" title="Parallelization Configurations:"></a>Parallelization Configurations:</h5><ul>
<li><strong>D</strong>: Data Parallelization: partition requests and assign them to different pipelines</li>
<li><strong>P</strong>: Pipeline model parallelization: run different stages of a inference process simultaneously (like pipeline in CPU)</li>
<li><strong>M</strong>: Tensor model parallelization: split the model into shards and assign to different GPUsParallel </li>
<li>Configuration <strong>C</strong> &#x3D; (D, P, M)</li>
</ul>
<p><img src="https://lh7-us.googleusercontent.com/vyC2ivtUjb6jx-4a44Fb-CCILGpqTHIEZMD-sRazYRNajDIa6vzZqFXZHArPoHxWMf5MCoAV3lVPlg2r4O3YBeunuAMUd0tM3K6b-MYiMbfvqvoyXCeVAB_1UdUjL5LFmbTta3KVMqO1xVF8CMCfSj4M0w=s2048" alt="img"></p>
<p><img src="https://lh7-us.googleusercontent.com/UgHiPq-iqfUTUlfZ_eKKxCdAKfGLZ35NR8BfY9Fysni41dIrpP4mwr2jlxwCZq5_W2W-pTUv4ptNxZ0NTF5lYBbXBIXXdNyrzF5aTfRP-tRd5i6uhKirSBcDYuvl4LGq_TBrEBgU7TpoczmxQTtrBP4weQ=s2048" alt="img"></p>
<h5 id="Configuration-Optimizer"><a href="#Configuration-Optimizer" class="headerlink" title="Configuration Optimizer"></a>Configuration Optimizer</h5><p><img src="https://lh7-us.googleusercontent.com/vzMkndwQq5s5d6cRu5F28hXBWyoeNyr7_5-GZZgR-MG9ntKYYiWoiZLk5JWeBT99xYLULeWop0OObtPAduL5HGPQ2pO0gCz7dqPS3SGl3M0DXXOzbzIbShbMAlZMrdbLLGDV5HoI0EMUM75r5OLS5u0BCw=s2048" alt="img"></p>
<p><strong>If</strong> there is a configuration such that the throughput is larger than the request arrival rate, <strong>then</strong> choose the configuration that has minimum inference latency while making sure the throughput is larger than arrival rate. <strong>Otherwise</strong>, find the C for maximum throughput.</p>
<p><strong>After</strong> adjusting the configuration, allocate or free instances. </p>
<p>Offline process &#x3D;&gt; low latency</p>
<p><strong>What do we have now?</strong></p>
<ul>
<li>We now have a configuration for the next step.</li>
<li>However, we only decided the parallelization structure. </li>
<li>How should us decide how to map the physical instances to logical positions?</li>
</ul>
<h4 id="Device-Mapper"><a href="#Device-Mapper" class="headerlink" title="Device Mapper"></a><strong>Device Mapper</strong></h4><ul>
<li><strong>Goal</strong>: find the matching strategy that maximize reusable context (i.e., edge weight sum)</li>
</ul>
<p><img src="https://lh7-us.googleusercontent.com/uIwqLoTUUz66a9PkQfiKllRlJP7g_mo73tNQUaVjOgzxk2FGEubdwFaqxXFLd-CJTUpHL-xhb7aZgu2RdAtBXWbS-1_l_RPJRRJwtD8xm5-b1d_sXZGh0ZbjowZCw59DEeYrJeWKPAxD65Z8Hl4A6kYy_A=s2048" alt="img"></p>
<ul>
<li><strong>Approach</strong>: *KM (*<em>Kuhn-Munkres) Algorithm</em> for Bipartite Graph Maximum Weight Matching</li>
</ul>
<p><img src="D:\dingblog\source\img\spotserve\bigraph.png"></p>
<p>edges: e(u, v) indicates reusable parameters and caches when mapping GPU u to position v.</p>
<h4 id="Migration-Planner"><a href="#Migration-Planner" class="headerlink" title="Migration Planner"></a><strong>Migration Planner</strong></h4><p><img src="https://lh7-us.googleusercontent.com/yUY4QY3JBuc3frOpU9igRxgFR7OXxeromn776cGPdnrL47ib7u-Ixyp4WK22dylnd_ehyGMxLcHoikY0isDt18P4eeiCbd2sNgwIxJj3LJfo8dnhQQZwF6fTUidE8uEnhKw0Aspop76el-NK5_jqDSmHZQ=s2048" alt="img"></p>
<ol>
<li>From front layers (0, 1) to back layers (N), find the layers whose context do not exceed the buffer size and prioritize migration of these layers. </li>
<li>For other layers, add them to the sequence by the order of instance buffer memory usage</li>
<li>After we have the sequence, sequentially migrate the layers in this sequence. If all layers of a specific stage is migrated, start running this stage.</li>
</ol>
<h3 id="Just-in-time-Arrangement"><a href="#Just-in-time-Arrangement" class="headerlink" title="Just-in-time Arrangement"></a>Just-in-time Arrangement</h3><p>What should we do if we receive a preemption&#x2F;acquisition notification while there are still requests running&#x2F;waiting?</p>
<ul>
<li>Immediately suspend and migrate? &#x3D;&gt; high inference latency</li>
<li>Finish all requests? &#x3D;&gt; no enough time for migration</li>
<li><strong>SpotServe</strong>: for preemption, maximize token generation (since migration happens during the grace period); for acquisition, minimize token generation when exploiting the whole grace period (since migration happens after the grace period)</li>
</ul>
<h2 id="Experimental-Evaluation"><a href="#Experimental-Evaluation" class="headerlink" title="Experimental Evaluation"></a>Experimental Evaluation</h2><h3 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison"></a>Comparison</h3><ul>
<li><p>Stable workload</p>
</li>
<li><p>P99: latency at the 99th percentage (99% latency &lt;&#x3D; this value)</p>
</li>
<li><p>Baselines: FasterTransformer (reparallelization but no cocntext migration, rerouting with pre-defined config)</p>
<p><img src="https://lh7-us.googleusercontent.com/8wenNdhNJT1VmN05N0gxrNKqk8qT9xCcZa3uZPePmr35xKSSD1U570V3iEtrlei8-zknw3xUJ4sytACMj_iX-t4Q04UHQyTt6tYhYdXreqnYWplghxE_KIWClBYdpqLAyr5ezVns4JNFY-MY1sQ1efa9zw=s2048" alt="img"></p>
</li>
<li><p>Fluctuating Workload</p>
<p><img src="https://lh7-us.googleusercontent.com/bpEki4DA2MEqzMuhU1nxpj5XOjf6AsjtdWnMpA7DN8GdnbcQd5wVhbgjc6WDs8mFIWf75OlkEMxxBDJ_GAMFwfaL5_imDBvvXSgHAM3jSFm9yIx8n6qqT7F-M2tRLfhvQO3mxoAxPV_3N2msXSgp2ik-Xw=s2048" alt="img"></p>
</li>
</ul>
<h3 id="Ablation"><a href="#Ablation" class="headerlink" title="Ablation"></a>Ablation</h3><p><img src="https://lh7-us.googleusercontent.com/dpK-WvVOgT4EO9BgpTm3HpxJu1DS_IzSShStV--RNiDmU9RROzZobzd9yWV1HvPpaJ0d-dqn5zp1nXjWn1nbctUI-H46em5TNu3Bz5WdQBKqOrVV_HcIqzoqDdxZkU2A3QGr1cK9LrETho7MrDXPRqKeHg=s2048" alt="img"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-02-02T17:15:00.000Z" title="2/2/2024, 12:15:00 PM">2024-02-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.150Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/vector-db/">vector_db</a></span><span class="level-item">6 minutes read (About 947 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/02/Milvus/">Milvus, A Purpose-Built Vector Data Management System</a></p><div class="content"><h1 id="Milvus-A-Purpose-Built-Vector-Data-Management-System"><a href="#Milvus-A-Purpose-Built-Vector-Data-Management-System" class="headerlink" title="Milvus: A Purpose-Built Vector Data Management System"></a>Milvus: A Purpose-Built Vector Data Management System</h1><p>Author: Jianguo Wang ,et al.</p>
<h3 id="vector-database"><a href="#vector-database" class="headerlink" title="vector database"></a>vector database</h3><p><img src="https://lh7-us.googleusercontent.com/a1SSv6X8vFe2r4xKdwJtEs4gQZn1wZ0RoCCBWQeNyRfY5XoMlgPK3WDeeIylBIza92CYhsbici0HTGf0iNeIUZj-SRb5eqZQfXEX6QLCDCKpdtDAEUE06VT4zOJdThJPJJJGqjWh_1Fwqhx4e210APvifQ=s2048" alt="img"></p>
<p>A new type of database specialized in storing and querying vector data. </p>
<ul>
<li><p>Traditional relational databases: precise attribute-based searches</p>
</li>
<li><p>Vector database: approximate similarity-based vector searches: find the k-nearest vectors to the query.</p>
</li>
</ul>
<h3 id="Background-Motivation"><a href="#Background-Motivation" class="headerlink" title="Background &amp; Motivation"></a>Background &amp; Motivation</h3><p><img src="D:\dingblog\source\img\milvus\motivation.png"></p>
<h3 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h3><p>Current works have the following limitations:</p>
<ul>
<li>They are not full-fledged systems and cannot handle large amount of data</li>
<li>They cannot easily handle dynamic data while ensuring fast real-time searches</li>
<li>They do not support advanced query processing</li>
<li>They are not optimized for heterogeneous computing architecture with CPUs and GPUs</li>
</ul>
<h3 id="Milvus"><a href="#Milvus" class="headerlink" title="Milvus"></a>Milvus</h3><p>Milvus: a purpose-built vector data management system for managing large-scale and dynamic vector data to enable data science and AI applications.</p>
<p>Milvus incorporates query processing, indexing and storage management and CPU-GPU codesign into the whole system, successfully addressing the previous issues.</p>
<h4 id="Overall-Architecture-of-Milvus"><a href="#Overall-Architecture-of-Milvus" class="headerlink" title="Overall Architecture of Milvus"></a>Overall Architecture of Milvus</h4><p><img src="https://lh7-us.googleusercontent.com/fLfYZw5bi5SJqc526JvvWF9Cx-v3_mwoboDJgCSvyPyQZPXp9-9V09R0zzmJnSR_IJ5VzQ2cdgPujHesMvg7GIOmnH67yceAwLh3BDXYypLXBQCsHiMAfkhMSBf8fxVTnx-vCywD4YGqTruMwE_VB0XuzQ=s2048" alt="img"></p>
<h4 id="Query-Processing"><a href="#Query-Processing" class="headerlink" title="Query Processing"></a>Query Processing</h4><p>Support of query types:</p>
<ul>
<li>Vector Query (1 vector)</li>
<li><strong>Attribute Filtering</strong> (1 vector + n attribute constraints)<strong>(Advanced Query)</strong></li>
<li><strong>Multi-vector Query</strong> (n vectors)<strong>(Advanced Query)</strong></li>
</ul>
<p>Support of similarity functions:</p>
<ul>
<li>Euclidean distance</li>
<li>Inner product</li>
<li>Cosine similarity</li>
<li>Hamming distance</li>
<li>Jaccard distance</li>
</ul>
<h4 id="Attribute-Filtering"><a href="#Attribute-Filtering" class="headerlink" title="Attribute Filtering"></a>Attribute Filtering</h4><h5 id=""><a href="#" class="headerlink" title=""></a><img src="https://lh7-us.googleusercontent.com/PIxpQQ5Z7gQ1MACU9tAa6PSjklRxVUxmoLkX62A7-mFhSS_PPCgg7QmXoNU8hQZtn8-MkIa9QyzLXOIF8IZniVmDClHUvkxCUH88iuBP7SFyVzzMtErNFWB_WINUlC6e9gFy6QyJZ2KQZvAd59vPHIgMiA=s2048" alt="img"></h5><ul>
<li><p>A: ①obtain the satisfied vectors②fully scann them</p>
</li>
<li><p>B: ①obtain the satisfied vectors②use bitmap to find the answer</p>
</li>
<li><p>C: ①obtain more than k results②fully scan and find those satisfy the attribute constraint</p>
</li>
<li><p>D: estimate the cost of A,B,C and find the best one</p>
</li>
<li><p>E (Milvus): Partition-based filtering</p>
<ol>
<li>Create partitions for data</li>
<li>Maintain min-max indexes for different partitions</li>
<li>Skip the partitions whose range of attribute does not overlap with the queries’</li>
<li>Find the overlapping partitions, and apply strategy D(cost-based) within each partition</li>
</ol>
</li>
</ul>
<h4 id="Multi-vector-Queries"><a href="#Multi-vector-Queries" class="headerlink" title="Multi-vector Queries"></a>Multi-vector Queries</h4><ul>
<li><h5 id="For-decomposable-similarity-functions-Use-aggregate-functions-to-concentrate-the-vectors-and-find-the-k-nearest-neighbors-based-on-the-concentrated-vector-vector-fusion"><a href="#For-decomposable-similarity-functions-Use-aggregate-functions-to-concentrate-the-vectors-and-find-the-k-nearest-neighbors-based-on-the-concentrated-vector-vector-fusion" class="headerlink" title="For decomposable similarity functions: Use aggregate functions to concentrate the vectors and find the k nearest neighbors based on the concentrated vector (vector fusion)"></a>For decomposable similarity functions: Use aggregate functions to concentrate the vectors and find the k nearest neighbors based on the concentrated vector (vector fusion)</h5></li>
<li><p>For indecomposable similarity functions:</p>
</li>
</ul>
<p><img src="https://lh7-us.googleusercontent.com/2nbN36rss_FJXsQqeqROW-fWUY1oggQ7aHsP796HQdaQCTObmj09hl2koBem7ygklF9_iVH3Jg3A2GCUYbjmSQozPgdqe2jIgjqc8YCE9-HBJT_EQw1hK6NOTqXWCXhPynJHyr4CnnaMFppibQlTjMcZaA=s2048" alt="img"></p>
<h4 id="Indexing-Querying"><a href="#Indexing-Querying" class="headerlink" title="Indexing (Querying)"></a>Indexing (Querying)</h4><ul>
<li><p>Quantization-based Indexing: (Quantization: represent vectors with a codebook. First find n nearest clusters to q, then use the indexing to search within these clusters.)</p>
<ul>
<li><p>IVF_FLAT</p>
</li>
<li><p>IVF_SQ8</p>
</li>
<li><p>IVF_PQ</p>
<p><img src="https://lh7-us.googleusercontent.com/cQ7gqM4L-mFpA5ciP5EhImJx1pEpdO4lO5yWXXARHCgnVeDfLJcU8feY_Uc-ivjsKUzS-h5p_tGCnv5nSRARPKwspRN9DCXtt3_WhkmQZLdow7A7J97vm1QItFTehk6aFpiek_Qc7ow7X_wTIdxyjW90LQ=s2048" alt="img"></p>
</li>
</ul>
</li>
<li><p>Graph-based indexing:</p>
<ul>
<li>HNSW</li>
<li>RNSG</li>
</ul>
</li>
</ul>
<h4 id="Vector-and-Attribute-Storage"><a href="#Vector-and-Attribute-Storage" class="headerlink" title="Vector and Attribute Storage"></a>Vector and Attribute Storage</h4><p>To facilitate query processing, Milvus stores vectors and attributes in a columnar fasion.</p>
<ul>
<li><strong>Vectors</strong>: different vectors of entities are stored together correspondingly. </li>
<li><strong>Attributes</strong>: &lt;attr value, row ID&gt; pairs + skipping indexes (min-max) for pages</li>
</ul>
<p><img src="D:\dingblog\source\img\milvus\storage.png"></p>
<p>Milvus also relies on LRU-based buffer and supports multiple file systems.</p>
<h4 id="Optimizations-for-Heterogeneous-Computing"><a href="#Optimizations-for-Heterogeneous-Computing" class="headerlink" title="Optimizations for Heterogeneous Computing"></a>Optimizations for Heterogeneous Computing</h4><p>How to find the top k similar vectors for multiple queries efficiently?</p>
<ul>
<li>CPU-oriented Optimization</li>
<li>GPU-oriented Optimization</li>
<li>CPU-GPU codesign</li>
</ul>
<h4 id="CPU-oriented-Optimization"><a href="#CPU-oriented-Optimization" class="headerlink" title="CPU-oriented Optimization"></a>CPU-oriented Optimization</h4><ul>
<li><h5 id="Faiss-leveraged-OpenMP-to-realize-multi-threading-Each-thread-process-a-query-at-a-time-Two-issues"><a href="#Faiss-leveraged-OpenMP-to-realize-multi-threading-Each-thread-process-a-query-at-a-time-Two-issues" class="headerlink" title="Faiss leveraged OpenMP to realize multi-threading. Each thread process a query at a time. Two issues:"></a><strong>Faiss</strong> leveraged OpenMP to realize multi-threading. Each thread process a query at a time. Two issues:</h5><ul>
<li>High cache-missing rate (requires to stream the entire data into caches, cannot reuse)</li>
<li>Cannot fully exploit cores when query number is small</li>
</ul>
</li>
<li><p><strong>Milvus</strong> assign threads to data vectors instead of query vectors to address the 2nd issue.</p>
<ul>
<li>Divide the queries into blocks s.t. each query block and its heaps can fit in L3 cache.</li>
<li>Results are managed in heaps. To obtain the final results, merge the result.</li>
<li>Milvus is also capable of automatically choosing SIMD instructions for functions.</li>
</ul>
</li>
</ul>
<h5 id="GPU-oriented-Optimization"><a href="#GPU-oriented-Optimization" class="headerlink" title="GPU-oriented Optimization"></a>GPU-oriented Optimization</h5><ul>
<li><strong>Faiss</strong>: k&lt;&#x3D;1024 because of the limit of memory</li>
<li><strong>Milvus</strong>: divide k into different rounds, each round expanding the obtained result set until reaches the required number.Faiss: must set the number of GPUs in advance; dynamic segment-based scheduling that assign search tasks to available devices</li>
</ul>
<h5 id="CPU-GPU-Co-design"><a href="#CPU-GPU-Co-design" class="headerlink" title="CPU-GPU Co-design"></a>CPU-GPU Co-design</h5><ul>
<li><p>Limitations of <strong>Faiss</strong> (IVF_SQ8):Low PCIe bandwidth utilization (1 bucket per time)Data transfer makes GPU computing unbeneficial</p>
</li>
<li><p><strong>Milvus</strong> (SQ8H):High bandwidth utilization (Multiple buckets loaded per time)Assess the running mode (GPU-only or hybrid) based on the batch size</p>
<p><img src="https://lh7-us.googleusercontent.com/1bi-T_L1k4IU-SxJ1jBMFvNr0yG9j_xd_6dVzgkk1XvZyRNptDrTs4MYPhyZX4lzrCA2enF8bQ06sYe_SKCdhR3TiuSA8dA4eesCGFZ2b6ZjtxB5ptqr-3KiTfyS7FFMEh6MNxuXI2IpTG9N2G3Uj-GS4A=s2048" alt="img"></p>
</li>
</ul>
<h3 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h3><ul>
<li>Recommender System</li>
<li><strong>Image Recognition</strong></li>
<li><strong>Chemical Structure Analysis</strong></li>
<li>etc.</li>
</ul>
<h3 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h3><h4 id="Evaluation-Comparing-with-other-systems"><a href="#Evaluation-Comparing-with-other-systems" class="headerlink" title="Evaluation (Comparing with other systems)"></a>Evaluation (Comparing with other systems)</h4><ul>
<li>10M vectors from SIFT1B and Deep1B</li>
<li>10000 random queries</li>
</ul>
<p><img src="https://lh7-us.googleusercontent.com/ENprp6rC88V22r2w7OkwVJ_iQCRo3JWz16ulMGvlaUWXf7yeBZPw4LG3N0ntxUXmMXHia-7ZOKVW5rLj6407GOoVLfTZPbeQTnDKER5bW9ImUvkkMiJvF9C8R2ngaaEovkgmOvAsRdMBW891rUByVLa5ZA=s2048" alt="img"></p>
<h4 id="Evaluation-cache-aware-design"><a href="#Evaluation-cache-aware-design" class="headerlink" title="Evaluation: cache-aware design"></a>Evaluation: cache-aware design</h4><p><img src="https://lh7-us.googleusercontent.com/5SyAZyajVqTUSdJOh2ROCylw6dl8Ri1EmLd-Fzz539KXGJq4XVcXVBfslC23JIFzRQXnGBSd2hXKl-A43FQoC66goZvL_nzjsZLeNt-PeWhFulHk_DyNN3TkoZ53SboSvDcVOra9R9dIpMwLmUa2Wg3aAA=s2048" alt="img"></p>
<h4 id="Evaluation-Attribute-Filtering"><a href="#Evaluation-Attribute-Filtering" class="headerlink" title="Evaluation-Attribute Filtering"></a>Evaluation-Attribute Filtering</h4><p><img src="https://lh7-us.googleusercontent.com/-m3podLKsG3KUBocsv_qeZMc1hfrs8SLUhxwradn7zReuSe3t9-Zy7we5VspsTUWl_lQvsFPXfIDb7dNdcvl5-dalb92GlQ1lm5bempLPhhgkqNyiDP2yhU2Gl6ydjX4QF7RU_5VOqgKLL66uYwzRuGsrw=s2048" alt="img"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-06-28T17:15:00.000Z" title="6/28/2023, 1:15:00 PM">2023-06-28</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-09-06T17:08:12.151Z" title="9/6/2025, 1:08:12 PM">2025-09-06</time></span><span class="level-item"><a class="link-muted" href="/categories/db-index/">db_index</a><span> / </span><a class="link-muted" href="/categories/db-index/predictive/">predictive</a></span><span class="level-item">13 minutes read (About 1973 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/06/28/Tiresias/">&lt;note&gt;Tiresias：Enabling Predictive Autonomous Storage and Indexing</a></p><div class="content"><h1 id="Tiresias：Enabling-Predictive-Autonomous-Storage-and-Indexing"><a href="#Tiresias：Enabling-Predictive-Autonomous-Storage-and-Indexing" class="headerlink" title="Tiresias：Enabling Predictive Autonomous Storage and Indexing"></a>Tiresias：Enabling Predictive Autonomous Storage and Indexing</h1><h2 id="亮点"><a href="#亮点" class="headerlink" title="亮点"></a>亮点</h2><p>主要的创新点是能够根据过去的对数据的访问预测未来的访问趋势，提前做出存储结构和索引的变化以适应新的事务或分析需求，即：通过训练，学习①访问的时间规律②访问的延迟预测函数。Tiresias只是根据当前和预测的情况，给出判断：是否应该改变布局，而不执行具体的改变布局的操作。</p>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><ol>
<li><p>Proteus中根据HTAP负载调整存储结构</p>
<p>把事务拆分成操作符（storage-specific），方便预测；</p>
<blockquote>
<p>这里的操作符意思是：根据存储结构和工作负载对事务进行拆分形成的单元，比如对于某个事务，分解成以下四个操作符：</p>
<p>① 向数据站点发送请求</p>
<p>② 获取锁</p>
<p>③ 按行更新</p>
<p>④ 提交</p>
<p>文中并未提及操作符是怎么得来的</p>
</blockquote>
<p>调用Tiresias记录操作符延迟和数据访问记录</p>
<p>预测新的数据访问到来的时间和频率</p>
<p>最后两步都有API</p>
</li>
<li><p>在OLAP DBMS上的predictive cracking</p>
<p>预测workload变化，改变数据存储</p>
</li>
<li><p>PostgreSQL上的自动索引</p>
<p>记录查询的到达历史、延迟和是否有二级索引（不在主键上创建的索引）</p>
<p>预测查询类型、延迟和是否有二级索引</p>
<p>根据Tiresias的预测，添加或去除二级索引</p>
</li>
</ol>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="数据访问延迟预测"><a href="#数据访问延迟预测" class="headerlink" title="数据访问延迟预测"></a>数据访问延迟预测</h3><p>将一个事务拆分成多个相连的操作符，对这些操作符分别计算损失函数再相加</p>
<ul>
<li>输入：a<del>1</del>，…，a<del>n</del>，是将一个操作符（operator）参数化，根据存储结构和工作负载提取的参数。</li>
<li>损失函数F：<ol>
<li><strong>线性回归</strong>：（因为速度快延迟小被采用）</li>
<li>非线性回归</li>
<li>神经网络（MLP）</li>
</ol>
</li>
<li>采集当前的延迟：采集起止时间和数据读写情况（读写列的总大小等），每个线程有一个observation数据结构，把每一个 &lt;存储结构-操作符&gt; 对应的所有latency保存为一个list，最后汇总在一起，用于训练</li>
</ul>
<h3 id="数据访问预测"><a href="#数据访问预测" class="headerlink" title="数据访问预测"></a>数据访问预测</h3><p>预测数据何时将要被以什么频次访问</p>
<p>预测 $δ(T, \tau)$，表示类型 T 的请求在 $\tau$ 时的一个时间窗口内到来的数量</p>
<h4 id="SPAR预测器"><a href="#SPAR预测器" class="headerlink" title="SPAR预测器"></a>SPAR预测器</h4><p>包含两部分：</p>
<ol>
<li><p>长期周期性变化：</p>
<p>每个小时、每天或者每年的规律。首先设定好要回顾多少个周期，$\psi _n$，考虑 前 $\psi _n$ 个周期的 δ 值，对它们进行加权，权重 b<del>i</del> 需要学习</p>
</li>
</ol>
<p><img src="/Tiresias/equation1.png"></p>
<ol start="2">
<li><p>短期内变化：</p>
<p>某一个短周期访问量相比于之前周期的变化。此处较难理解。首先看论文给出的公式：</p>
<p><img src="/Tiresias/equation2.png"></p>
<p>这个公式表示，对于某一个点，比较他的时间窗口内访问量i个周期前(1 ≤ i ≤ $\psi_n$)的对应点的窗口。比如说考虑请求量随时间按照正弦函数分布，如果 $\tau$ 时间在波谷，那么该公式就是将 $\tau$ 时刻的窗口内的访问量减去前 $\psi_n$ 个波谷的窗口内的访问量的平均值。通过该公式衡量当前点与之前周期的对应点的访问量的变化。</p>
<p>然后将连续 $\psi_k$ 个点的 γ 值加权求和。</p>
<p><img src="/Tiresias/equation3.png"></p>
<p>这两个公式结合在一起，意义是预测周期内的访问量变化的周期性。仍然以正弦函数为例，这个函数表征的就是$\psi_k$长度内访问量与n个周期之前$\psi_k$长度的区间内访问量有何差异。随着时间推移，通过这个公式，SPAR学习到的就是 “每个周期正弦函数都会有一个波浪形的下坡” 这个特征。</p>
<p>然后把这个式子和上面长期周期性变化的式子加起来得到 δ 的预测值</p>
</li>
</ol>
<h4 id="Hybrid-Ensemble预测器"><a href="#Hybrid-Ensemble预测器" class="headerlink" title="Hybrid-Ensemble预测器"></a>Hybrid-Ensemble预测器</h4><p>包含三部分：</p>
<ol>
<li><p>长期周期性变化：</p>
<p>LSTM</p>
</li>
<li><p>短期变化：</p>
<p>线性回归</p>
</li>
<li><p>用户自定义holiday list</p>
<p>设定起止时间和高斯函数(正态分布的概率密度)的参数，如果当前时间在起止时间之间，就用高斯函数计算访问量</p>
</li>
</ol>
<p><strong>访问历史</strong></p>
<p>每个分区记录一分钟的访问量，轮询收集，将收集到的访问量用于训练</p>
<ul>
<li>SPAR：采集前 $\psi_n$ 周期的数据存在环形缓冲区内</li>
<li>HE：使用LSTM，但是Tiresias仍需要保存长期的历史记录</li>
</ul>
<h3 id="评估存储结构和索引变化的获利"><a href="#评估存储结构和索引变化的获利" class="headerlink" title="评估存储结构和索引变化的获利"></a>评估存储结构和索引变化的获利</h3><p>对于存储布局的改变S，考虑两部分：</p>
<ol>
<li><p>改变布局本身的消耗：</p>
<p>U(S)</p>
</li>
<li><p>改变布局前后的消耗对比（收益）</p>
<p>对于当前结构和改变后的结构，分别使用相应的预测器预测事务的延迟L<del>current</del>和L<del>adapt</del></p>
<p>计算C(S)：当前请求的消耗函数</p>
<p>计算时间 $\tau$ 时到达T类型指令的可能性Pr(T)</p>
<p>计算到下一个T类型指令到来需要的时间Δ(T)</p>
<p>计算E(S, T)：在某一时间预期请求的消耗函数</p>
<p><img src="/Tiresias/equation4.png"></p>
<p>E决定于延迟的相对变化、请求到来的可能性、请求到来的时间（估计值）</p>
<p>特别地，如果当前正在处理该类型请求，那么Pr(T) &#x3D; 1, Δ(T) &#x3D; 0，带入就是C(S)，也就是当前结构对于当前类型请求的延迟和改变后结构对当前类型请求的延迟的差值 $L_{current}-L_{adapt}$</p>
</li>
</ol>
<p>最后综合这两部分</p>
<p>$N(S) &#x3D; \lambda (E(S)+C(S))-U(S)$</p>
<p>λ用于调控两者之间的相对权重</p>
<p>也就是说只有：在λ权重下，改变布局带来的收益大于改变布局本身的损失，即 N &gt; 0，才会认为改变布局是可以获利的</p>
<h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><h3 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h3><ul>
<li>CH-benCHmark：包含TPC-C OLTP workload和TPC-H OLAP workload</li>
<li>事务型YCSB workload：10个多键读取-修改-写入事务+1个扫描（5e5行）聚合OLAP查询</li>
</ul>
<h3 id="访问开销估计器对比"><a href="#访问开销估计器对比" class="headerlink" title="访问开销估计器对比"></a>访问开销估计器对比</h3><p>线性回归每轮训练耗时比神经网络和非线性回归分别快1500倍和2500倍，尽管精确度稍微低一些，但是对于判断改变的好坏还是足够了</p>
<p>线性回归初始精度更高，这样正好可以快速适应负载。</p>
<h3 id="访问预测器对比"><a href="#访问预测器对比" class="headerlink" title="访问预测器对比"></a>访问预测器对比</h3><p>SPAR精度更高，但是如果周期数设定不合理误差反而会大很多。预测的更易变（毛糙，因为会从之前的预测中继承噪音）空间开销小</p>
<h3 id="PostgreSQL自动索引效果"><a href="#PostgreSQL自动索引效果" class="headerlink" title="PostgreSQL自动索引效果"></a><strong>PostgreSQL自动索引效果</strong></h3><p>workload在5、10、15分钟会发生变化</p>
<p>比较了PortgreSQL+Tiresias, 有索引的PostgreSQL和无索引的PostgreSQL，结果为：</p>
<p>使用Tiresias的索引选取相比于不加索引和加索引，workload完成时间分别快了70%和15%</p>
<p>OLAP情况下，加索引最快，但是加索引会导致更新开销变大，因此OLTP情况下，加索引吞吐率最低，而Tiresias由于可以动态调整，因此在OLAP下与加索引速度相当，OLTP下速度与不加索引相当。</p>
<h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><p><a target="_blank" rel="noopener" href="https://github.com/mtabebe/Adaptive-Storage-Tiresias-and-Proteus/tree/master">https://github.com/mtabebe/Adaptive-Storage-Tiresias-and-Proteus/tree/master</a></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/2/">Previous</a></div><div class="pagination-next"><a href="/page/4/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link is-current" href="/page/3/">3</a></li><li><a class="pagination-link" href="/page/4/">4</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives/"><p class="title">36</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories/"><p class="title">15</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags/"><p class="title">28</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="me noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">22</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/C/"><span class="level-start"><span class="level-item">C++</span></span><span class="level-end"><span class="level-item tag">22</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/C/job/"><span class="level-start"><span class="level-item">job</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/Programming-Language/"><span class="level-start"><span class="level-item">Programming Language</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programming-Language/C/"><span class="level-start"><span class="level-item">C++</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/db-index/"><span class="level-start"><span class="level-item">db_index</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/db-index/predictive/"><span class="level-start"><span class="level-item">predictive</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/machine-learning/"><span class="level-start"><span class="level-item">machine learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/machine-learning/Dive-into-Deep-Learning-Notes/"><span class="level-start"><span class="level-item">Dive into Deep Learning-Notes</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/machine-learning/Dive-into-Deep-Learning-Notes/optimization/"><span class="level-start"><span class="level-item">optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/mlsys/"><span class="level-start"><span class="level-item">mlsys</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/"><span class="level-start"><span class="level-item">python</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/python/basics/"><span class="level-start"><span class="level-item">basics</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ubuntu/"><span class="level-start"><span class="level-item">ubuntu</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/vector-db/"><span class="level-start"><span class="level-item">vector_db</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-06T17:08:12.153Z">2025-09-06</time></p><p class="title"><a href="/2025/09/06/%E4%BD%BF%E7%94%A8vue%E5%92%8Celementui%E9%81%87%E5%88%B0%E7%9A%84%E5%90%84%E7%A7%8D%E5%9D%91/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-06T17:08:12.152Z">2025-09-06</time></p><p class="title"><a href="/2025/09/06/hello-world/">Hello World</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-06T17:08:12.150Z">2025-09-06</time></p><p class="title"><a href="/2025/09/06/CNN%20Convolution/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-06T17:08:12.150Z">2025-09-06</time></p><p class="title"><a href="/2025/09/06/MySQL%E4%B8%80%E4%BA%9B%E5%BA%95%E5%B1%82%E7%9A%84%E4%B8%9C%E8%A5%BF/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-20T17:50:00.000Z">2024-08-20</time></p><p class="title"><a href="/2024/08/20/lc_141_%E7%8E%AF%E5%BD%A2%E9%93%BE%E8%A1%A8/">&lt;数据结构/算法&gt; leetcode hot100系列. 141(142). 环形链表</a></p><p class="categories"><a href="/categories/Algorithm/">Algorithm</a> / <a href="/categories/Algorithm/C/">C++</a> / <a href="/categories/Algorithm/C/job/">job</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/09/"><span class="level-start"><span class="level-item">September 2025</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">June 2024</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/STL/"><span class="tag">STL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/backtrack/"><span class="tag">backtrack</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/binary-tree/"><span class="tag">binary-tree</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/copy/"><span class="tag">copy</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cpu-gpu-co-design/"><span class="tag">cpu-gpu co-design</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/distributed-system/"><span class="tag">distributed system</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/distribution-shift/"><span class="tag">distribution shift</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dp/"><span class="tag">dp</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/greenplum/"><span class="tag">greenplum</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hash/"><span class="tag">hash</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/heap/"><span class="tag">heap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/index/"><span class="tag">index</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mlsys/"><span class="tag">mlsys</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/optimization/"><span class="tag">optimization</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/predict/"><span class="tag">predict</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python37/"><span class="tag">python37</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/slide-window/"><span class="tag">slide-window</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sort/"><span class="tag">sort</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/two-pointers/"><span class="tag">two-pointers</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/variable/"><span class="tag">variable</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vector-database/"><span class="tag">vector database</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2025 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>